# 宝东商城

## 前言

从单体项目到微服务到服务网格的这么一个演化过程

### 意识

意识：

1. 好的技术和架构都是演化来的。杜绝过度设计。
2. 功能先有后优。
3. 好的设计图，架构图，业务逻辑图，时序图等，充满美感
4. 好多牛X的人，都是不断发现自己是傻X的过程。不知道自己不知道，才可怕。
5. 有问题自己先思考再问。（自己没有答案之前不要问）
6. 依赖了别人就是放弃了自己

### 一个项目的流程

企业中怎么做项目？你要去企业中做一个项目，首先是有一个叫产品经理的角色给你需求。但就是给你一份一份产品文档，可能是原型图，可能是一个word。对着需求写好设计文档，写代码的时候就照着敲就行。记录好自己开发的思路，哪怕简单的画画几个图，不然自己写的代码过了两周自己都看不懂。

需求出来之后有一个项目的启动会，一般在互联网公司中叫Kick Off。小公司开发和测试可能没有并行，但是大一点的都是开发测试并行的。你写后端的开发之前肯定要定义好接口，定好了才去开发，然后测试对着你的接口写测试用例。

开发开始了，做设计，设计完了编码，还有一轮评审。测试也写它的TC。然后测试没问题了才发布。

<img src="image/01.jpg" alt="01" style="zoom: 80%;" />

### 规范

开发规范，阿里规约，命名、日志、错误码、数据库建表等等的规定。

### 工程结构

项目结构是用maven的一个聚合工程。父项目下面是子项目

```xml
父项目
----子项目
----子项目

pom.xml
```

父项目一般以parent结尾。下面有很多子项目，应用入口、接口、实现、工具。

```xml
msb-dongbao-mall-parent        	父项目
--msb-dongbao-mall-application 	入口（controller）
--msb-dongbao-mall-api			接口（controller调用api）
	--msb-dongbao-cms-api
	--msb-dongbao-cart-api		购物车api代码
    --msb-dongbao-pms-api		商品中心api代码
	--msb-dongbao-dictionary-api
	--msb-dongbao-oms-api
	--msb-dongbao-pay-api
	--msb-dongbao-sms-api
	--msb-dongbao-ums-api

--msb-dongbao-mall-service		接口的实现层(api的实现层)
	--xxxx项目
--msb-dongbao-mall-common		通用工具类

pom.xml
```



创建一个maven项目，写好groupID，看下面规范。

```
1.【强制】定义 GAV 遵从以下规则：
1） GroupID 格式：com.{公司/BU }.业务线 [.子业务线]，最多 4 级。
说明：{公司/BU} 例如：alibaba/taobao/tmall/aliexpress 等 BU 一级；子业务线可选。
正例：com.taobao.jstorm 或 com.alibaba.dubbo.register
```

| ![image-20230422210512975](image/image-20230422210512975.png) |      |
| ------------------------------------------------------------ | ---- |

进来之后pom文件中，由于是父项目，不打成jar或者war。我们这里写pom。

<img src="image/image-20230422210816200.png" alt="image-20230422210816200" style="zoom:67%;" />

然后去创建这个父项目的子项目。父项目通过modules标签来管理它下面的所有的模块，要作为父的模块，就在下面打标签，当然这里帮你打了。

![image-20230422211207772](image/image-20230422211207772.png)

按照下面，把所有的项目的骨架搭建好。父项目的子项目可能还有子项目，就在里面继续创建module即可。分了三层。

只有`msb-dongbao-mall-parent`和`msb-dongbao-api`是pom，其它都不是pom。例如`msb-dongbao-oms-api`就是一个jar，它会编译成一个jar包，让别的模块来引用。也就是`msb-dongbao-oms-api`编译之后会变成`msb-dongbao-oms-api.jar`，别的项目A要用就在A项目的pom文件中写上`msb-dongbao-oms-api.ja`r的坐标，坐标就是`<artifactId> + <GroupId> + <version>`。

也就是一二层都是pom，一二层的模块建起来之后src都要删掉。只有第三层才不删，第三层才是写代码的地方。

建立这么多的module，是为了把模块分开。两个业务模块在两个工程中开发会更好的协作，更能提交的时候减少代码的冲突。以后拆服务、要向微服务进化的时候，模块可以直接独立出去就是一个微服务了。这样的项目重构的话，搞上注册中心，瞬间就变成了微服务了。

```
代码模块介绍
msb-dongbao-mall-parent        	父项目
	msb-dongbao-common 公共包
		msb-dongbao-common-base 公共基础类
		msb-dongbao-common-util 工具类
	msb-dongbao-api 业务模块接口层
		msb-dongbao-oms-api 订单中心接口
		msb-dongbao-pms-api 商品中心接口
		msb-dongbao-ums-api 用户中心接口
		msb-dongbao-pay-api 支付中心接口
		msb-dongbao-cart-api 购物车接口
		msb-dongbao-dictionary-api 基础字典接口
		msb-dongbao-sms-api 优惠中心接口
		msb-dongbao-cms-api 内容中心接口
	msb-dongbao-service 业务模块实现层
		msb-dongbao-oms 订单中心模块实现
		msb-dongbao-pms 商品中心模块实现
		msb-dongbao-ums 用户中心模块实现
		msb-dongbao-pay 支付中心模块实现
		msb-dongbao-cart 购物车模块实现
		msb-dongbao-dictionary 基础字典模块实现
		msb-dongbao-sms 优惠中心模块实现
		msb-dongbao-cms 内容中心模块实现
	msb-dongbao-application web应用模块

	    msb-dongbao-manager-web 后台管理应用
		msb-dongbao-portal-web 商城门户网站
	msb-dongbao-job 定时任务模块

	msb-dongbao-generator 代码生成器
```













## 代码生成器准备 

